"use strict";(self.webpackChunkeventpulse_frontend=self.webpackChunkeventpulse_frontend||[]).push([[108],{108:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var l=a(9379),n=a(5043),r=a(8729),i=a(3216),o=a(7503),d=a(1614),c=a(579);const t=e=>{let{user:s}=e;const a=(null===s||void 0===s?void 0:s.qrCode)||(null===s||void 0===s?void 0:s._id)||"";return(0,c.jsx)("div",{className:"user-qr-code-container",children:(0,c.jsxs)("div",{className:"qr-code-card",children:[(0,c.jsx)("h3",{children:"Your Profile QR Code"}),(0,c.jsx)("p",{children:"Scan this code to view your profile"}),(0,c.jsx)("div",{className:"qr-code-wrapper",children:(0,c.jsx)(d.hp,{id:"user-qr-code",value:a,size:200,level:"H",includeMargin:!0})}),(0,c.jsx)("button",{className:"btn btn-secondary",onClick:()=>{const e=document.getElementById("user-qr-code"),a=(new XMLSerializer).serializeToString(e),l=document.createElement("canvas"),n=l.getContext("2d"),r=new Image;r.onload=()=>{l.width=r.width,l.height=r.height,n.drawImage(r,0,0);const e=l.toDataURL("image/png"),a=document.createElement("a");a.download="".concat((null===s||void 0===s?void 0:s.name)||"user","-qr-code.png"),a.href=e,a.click()},r.src="data:image/svg+xml;base64,"+btoa(a)},children:"Download QR Code"})]})})};var m=a(4505);const h=()=>{var e,s,a,d,h,u;const{user:v,updateProfile:x,logout:p}=(0,r.A)(),j=(0,i.Zp)(),[b,g]=(0,n.useState)(!1),[N,f]=(0,n.useState)(!1),[w,y]=(0,n.useState)(!1),[C,P]=(0,n.useState)(!1),[k,E]=(0,n.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[A,D]=(0,n.useState)(""),[S,R]=(0,n.useState)({name:(null===v||void 0===v?void 0:v.name)||"",email:(null===v||void 0===v?void 0:v.email)||"",phone:(null===v||void 0===v?void 0:v.phone)||"",grade:(null===v||void 0===v?void 0:v.grade)||"",house:(null===v||void 0===v?void 0:v.house)||""}),L=e=>{R((0,l.A)((0,l.A)({},S),{},{[e.target.name]:e.target.value}))},q=async e=>{e.preventDefault(),f(!0);(await x(S)).success&&g(!1),f(!1)};return(0,c.jsxs)("div",{className:"profile-page",children:[(0,c.jsx)("div",{className:"page-header",children:(0,c.jsxs)("div",{className:"container",children:[(0,c.jsx)("h1",{children:"My Profile"}),(0,c.jsx)("p",{children:"Manage your account settings and preferences"})]})}),(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"profile-grid",children:[(0,c.jsxs)("div",{className:"profile-card",children:[(0,c.jsxs)("div",{className:"profile-header",children:[(0,c.jsx)("div",{className:"profile-avatar-large",children:null!==v&&void 0!==v&&v.avatar?(0,c.jsx)("img",{src:v.avatar,alt:v.name}):(0,c.jsx)("span",{children:null===v||void 0===v||null===(e=v.name)||void 0===e?void 0:e.charAt(0).toUpperCase()})}),(0,c.jsxs)("div",{className:"profile-header-info",children:[(0,c.jsx)("h2",{children:null===v||void 0===v?void 0:v.name}),(0,c.jsx)("p",{className:"profile-role",children:null===v||void 0===v?void 0:v.role}),(null===v||void 0===v?void 0:v.house)&&(0,c.jsxs)("span",{className:"house-badge",style:{background:(H=v.house,{Red:"#ef4444",Blue:"#3b82f6",Green:"#10b981",Yellow:"#f59e0b"}[H]||"#6366f1")},children:[v.house," House"]})]})]}),(0,c.jsxs)("div",{className:"profile-stats",children:[(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)("div",{className:"stat-value",children:(null===v||void 0===v?void 0:v.points)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Points"})]}),(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)("div",{className:"stat-value",children:(null===v||void 0===v||null===(s=v.badges)||void 0===s?void 0:s.length)||0}),(0,c.jsx)("div",{className:"stat-label",children:"Badges"})]}),(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)("div",{className:"stat-value",children:"0"}),(0,c.jsx)("div",{className:"stat-label",children:"Events"})]})]}),(null===v||void 0===v?void 0:v.badges)&&v.badges.length>0&&(0,c.jsxs)("div",{className:"badges-section",children:[(0,c.jsx)("h3",{children:"Achievements"}),(0,c.jsx)("div",{className:"badges-grid",children:v.badges.map((e,s)=>(0,c.jsxs)("div",{className:"badge-card",children:[(0,c.jsx)("div",{className:"badge-icon-large",children:e.icon||"\ud83c\udfc6"}),(0,c.jsx)("div",{className:"badge-name",children:e.name}),(0,c.jsx)("div",{className:"badge-date",children:new Date(e.earnedAt).toLocaleDateString()})]},s))})]})]}),(0,c.jsxs)("div",{className:"profile-form-card",children:[(0,c.jsxs)("div",{className:"form-header",children:[(0,c.jsx)("h3",{children:"Personal Information"}),b?(0,c.jsxs)("div",{className:"form-actions-header",children:[(0,c.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:()=>{R({name:(null===v||void 0===v?void 0:v.name)||"",email:(null===v||void 0===v?void 0:v.email)||"",phone:(null===v||void 0===v?void 0:v.phone)||"",grade:(null===v||void 0===v?void 0:v.grade)||"",house:(null===v||void 0===v?void 0:v.house)||""}),g(!1)},children:"Cancel"}),(0,c.jsx)("button",{className:"btn btn-primary btn-sm",onClick:q,disabled:N,children:N?"Saving...":"Save Changes"})]}):(0,c.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:()=>g(!0),children:[(0,c.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"18",height:"18",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Profile"]})]}),(0,c.jsxs)("form",{onSubmit:q,className:"profile-form",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Full Name"}),(0,c.jsx)("input",{type:"text",name:"name",value:S.name,onChange:L,className:"form-input",disabled:!b,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Email Address"}),(0,c.jsx)("input",{type:"email",name:"email",value:S.email,onChange:L,className:"form-input",disabled:!b,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Phone Number"}),(0,c.jsx)("input",{type:"tel",name:"phone",value:S.phone,onChange:L,className:"form-input",disabled:!b,placeholder:"Enter your phone number"})]}),"student"===(null===v||void 0===v?void 0:v.role)&&(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Grade"}),(0,c.jsx)("input",{type:"text",name:"grade",value:S.grade,onChange:L,className:"form-input",disabled:!b,placeholder:"e.g., 10"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"House"}),(0,c.jsxs)("select",{name:"house",value:S.house,onChange:L,className:"form-select",disabled:!b,children:[(0,c.jsx)("option",{value:"",children:"Select House"}),(0,c.jsx)("option",{value:"Marsh",children:"Marsh"}),(0,c.jsx)("option",{value:"Reed",children:"Reed"}),(0,c.jsx)("option",{value:"Boake",children:"Boake"}),(0,c.jsx)("option",{value:"Harward",children:"Harward"}),(0,c.jsx)("option",{value:"Hartley",children:"Hartley"})]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Account Type"}),(0,c.jsx)("input",{type:"text",value:null===v||void 0===v?void 0:v.role,className:"form-input",disabled:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Member Since"}),(0,c.jsx)("input",{type:"text",value:new Date((null===v||void 0===v?void 0:v.createdAt)||Date.now()).toLocaleDateString(),className:"form-input",disabled:!0})]})]}),(0,c.jsxs)("div",{className:"preferences-section",children:[(0,c.jsx)("h3",{children:"Notification Preferences"}),(0,c.jsxs)("div",{className:"preferences-list",children:[(0,c.jsxs)("label",{className:"preference-item",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"preference-label",children:"Email Notifications"}),(0,c.jsx)("div",{className:"preference-description",children:"Receive event updates via email"})]}),(0,c.jsx)("input",{type:"checkbox",className:"toggle-switch",defaultChecked:null===v||void 0===v||null===(a=v.preferences)||void 0===a||null===(d=a.notifications)||void 0===d?void 0:d.email})]}),(0,c.jsxs)("label",{className:"preference-item",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"preference-label",children:"Push Notifications"}),(0,c.jsx)("div",{className:"preference-description",children:"Get real-time push notifications"})]}),(0,c.jsx)("input",{type:"checkbox",className:"toggle-switch",defaultChecked:null===v||void 0===v||null===(h=v.preferences)||void 0===h||null===(u=h.notifications)||void 0===u?void 0:u.push})]})]})]}),(0,c.jsx)(t,{user:v}),(0,c.jsxs)("div",{className:"danger-zone",children:[(0,c.jsx)("h3",{children:"Danger Zone"}),(0,c.jsxs)("div",{className:"danger-actions",children:[(0,c.jsx)("button",{className:"btn btn-outline",onClick:()=>y(!0),children:"Change Password"}),(0,c.jsx)("button",{className:"btn btn-outline",style:{borderColor:"var(--error)",color:"var(--error)"},onClick:()=>P(!0),children:"Delete Account"})]})]})]})]})}),w&&(0,c.jsx)("div",{className:"modal-overlay",onClick:()=>y(!1),children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h3",{children:"Change Password"}),(0,c.jsx)("button",{className:"modal-close",onClick:()=>y(!1),children:"\xd7"})]}),(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),k.newPassword===k.confirmPassword)if(k.newPassword.length<6)o.oR.error("Password must be at least 6 characters");else{f(!0);try{await m.R2.changePassword({currentPassword:k.currentPassword,newPassword:k.newPassword}),o.oR.success("Password changed successfully"),y(!1),E({currentPassword:"",newPassword:"",confirmPassword:""})}catch(l){var s,a;o.oR.error((null===(s=l.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to change password")}finally{f(!1)}}else o.oR.error("New passwords do not match")},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Current Password"}),(0,c.jsx)("input",{type:"password",className:"form-input",value:k.currentPassword,onChange:e=>E((0,l.A)((0,l.A)({},k),{},{currentPassword:e.target.value})),required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"New Password"}),(0,c.jsx)("input",{type:"password",className:"form-input",value:k.newPassword,onChange:e=>E((0,l.A)((0,l.A)({},k),{},{newPassword:e.target.value})),required:!0,minLength:6})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Confirm New Password"}),(0,c.jsx)("input",{type:"password",className:"form-input",value:k.confirmPassword,onChange:e=>E((0,l.A)((0,l.A)({},k),{},{confirmPassword:e.target.value})),required:!0})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn btn-ghost",onClick:()=>y(!1),children:"Cancel"}),(0,c.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:N,children:N?"Changing...":"Change Password"})]})]})]})}),C&&(0,c.jsx)("div",{className:"modal-overlay",onClick:()=>P(!1),children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h3",{children:"Delete Account"}),(0,c.jsx)("button",{className:"modal-close",onClick:()=>P(!1),children:"\xd7"})]}),(0,c.jsxs)("div",{className:"modal-body",children:[(0,c.jsxs)("p",{style:{color:"var(--error)",marginBottom:"1rem"},children:[(0,c.jsx)("strong",{children:"Warning:"})," This action cannot be undone. All your data will be permanently deleted."]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{className:"form-label",children:["Type ",(0,c.jsx)("strong",{children:"DELETE"})," to confirm"]}),(0,c.jsx)("input",{type:"text",className:"form-input",value:A,onChange:e=>D(e.target.value),placeholder:"DELETE"})]})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"btn btn-ghost",onClick:()=>P(!1),children:"Cancel"}),(0,c.jsx)("button",{className:"btn btn-primary",style:{background:"var(--error)"},onClick:async()=>{if("DELETE"===A){f(!0);try{await m.R2.deleteAccount(),o.oR.success("Account deleted successfully"),p(),j("/login")}catch(a){var e,s;o.oR.error((null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to delete account"),f(!1)}}else o.oR.error("Please type DELETE to confirm")},disabled:N||"DELETE"!==A,children:N?"Deleting...":"Delete Account"})]})]})})]});var H}}}]);
//# sourceMappingURL=108.cef84a03.chunk.js.map