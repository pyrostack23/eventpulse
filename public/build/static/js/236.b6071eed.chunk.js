"use strict";(self.webpackChunkeventpulse_frontend=self.webpackChunkeventpulse_frontend||[]).push([[236],{1236:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(5043),s=n(4505),a=n(7842),d=n(7503),r=n(8729),o=n(6485),l=n(579);const c=()=>{const{user:e}=(0,r.A)(),[t,n]=(0,i.useState)([]),[c,h]=(0,i.useState)(!0),[v,m]=(0,i.useState)("upcoming"),[u,x]=(0,i.useState)(null);(0,i.useEffect)(()=>{j()},[]);const j=async()=>{try{const e=await s.XO.getMyRegistrations();n(e.data.registrations||[])}catch(e){console.error("Error loading registrations:",e),d.oR.error("Failed to load your events")}finally{h(!1)}},p=e=>{const n=new Date;return t.filter(t=>{var i;const s=new Date(null===(i=t.event)||void 0===i?void 0:i.startDate);switch(e){case"upcoming":return s>n&&!t.attended;case"attended":return t.attended;case"past":return s<n&&!t.attended;default:return!0}})},g=p(v);return c?(0,l.jsx)("div",{className:"loading-overlay",children:(0,l.jsx)("div",{className:"spinner"})}):(0,l.jsxs)("div",{className:"my-events-page",children:[(0,l.jsx)("div",{className:"page-header",children:(0,l.jsxs)("div",{className:"container",children:[(0,l.jsx)("h1",{children:"My Events"}),(0,l.jsx)("p",{children:"Manage your event registrations and attendance"})]})}),(0,l.jsxs)("div",{className:"container",children:[(0,l.jsxs)("div",{className:"tabs-container",children:[(0,l.jsxs)("button",{className:"tab ".concat("upcoming"===v?"active":""),onClick:()=>m("upcoming"),children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"20",height:"20",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Upcoming",(0,l.jsx)("span",{className:"tab-count",children:p("upcoming").length})]}),(0,l.jsxs)("button",{className:"tab ".concat("attended"===v?"active":""),onClick:()=>m("attended"),children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"20",height:"20",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Attended",(0,l.jsx)("span",{className:"tab-count",children:p("attended").length})]}),(0,l.jsxs)("button",{className:"tab ".concat("past"===v?"active":""),onClick:()=>m("past"),children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"20",height:"20",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Past",(0,l.jsx)("span",{className:"tab-count",children:p("past").length})]})]}),g.length>0?(0,l.jsx)("div",{className:"events-list",children:g.map(e=>{var t,n,i,r,o,c,h;return(0,l.jsxs)("div",{className:"event-item",children:[(0,l.jsx)("div",{className:"event-item-image",children:null!==(t=e.event)&&void 0!==t&&t.image?(0,l.jsx)("img",{src:e.event.image,alt:e.event.title}):(0,l.jsx)("div",{className:"event-placeholder",children:(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,l.jsxs)("div",{className:"event-item-content",children:[(0,l.jsxs)("div",{className:"event-item-header",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"event-category",children:null===(n=e.event)||void 0===n?void 0:n.category}),(0,l.jsx)("h3",{children:null===(i=e.event)||void 0===i?void 0:i.title})]}),(0,l.jsx)("span",{className:"badge ".concat(e.attended?"badge-success":"badge-info"),children:e.attended?"Attended":"Registered"})]}),(0,l.jsx)("p",{className:"event-description",children:null===(r=e.event)||void 0===r?void 0:r.description}),(0,l.jsxs)("div",{className:"event-item-meta",children:[(0,l.jsxs)("div",{className:"meta-item",children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"18",height:"18",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,a.A)(new Date(null===(o=e.event)||void 0===o?void 0:o.startDate),"PPP")]}),(0,l.jsxs)("div",{className:"meta-item",children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"18",height:"18",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.A)(new Date(null===(c=e.event)||void 0===c?void 0:c.startDate),"p")]}),(0,l.jsxs)("div",{className:"meta-item",children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"18",height:"18",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),null===(h=e.event)||void 0===h?void 0:h.location]})]}),(0,l.jsxs)("div",{className:"event-item-actions",children:["upcoming"===v&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{x(e)})(e),children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"18",height:"18",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Show QR Code"]}),(0,l.jsx)("button",{className:"btn btn-sm btn-outline",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to cancel this registration?"))try{await s.XO.cancel(e),d.oR.success("Registration cancelled successfully"),j()}catch(t){console.error("Error cancelling registration:",t),d.oR.error("Failed to cancel registration")}})(e._id),children:"Cancel Registration"})]}),e.attended&&(0,l.jsxs)("div",{className:"attended-badge",children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"20",height:"20",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"You attended this event"]})]})]})]},e._id)})}):(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"64",height:"64",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,l.jsxs)("h3",{children:["No ",v," events"]}),(0,l.jsxs)("p",{children:["You don't have any ",v," events at the moment"]})]})]}),u&&(0,l.jsx)("div",{className:"modal-overlay",onClick:()=>x(null),children:(0,l.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h3",{children:"Event Ticket"}),(0,l.jsx)("button",{className:"modal-close",onClick:()=>x(null),children:(0,l.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:"24",height:"24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsx)("div",{className:"modal-body",children:(0,l.jsx)(o.A,{userId:e._id,eventId:u.event._id,registrationId:u._id,eventTitle:u.event.title,eventDate:u.event.startDate})})]})})]})}},6485:(e,t,n)=>{n.d(t,{A:()=>a});n(5043);var i=n(1614),s=n(579);const a=e=>{let{registration:t}=e;const n=(null===t||void 0===t?void 0:t.qrCode)||"",a=null===t||void 0===t?void 0:t.event,d=!(null===a||void 0===a||!a.endDate)&&new Date>new Date(a.endDate),r=(null===t||void 0===t||t.paymentStatus,"not_required"===(null===t||void 0===t?void 0:t.paymentStatus)),o="pending"===(null===t||void 0===t?void 0:t.paymentStatus);return(0,s.jsx)("div",{className:"event-ticket-qr",children:(0,s.jsxs)("div",{className:"ticket-card",children:[(0,s.jsxs)("div",{className:"ticket-header",children:[(0,s.jsx)("h3",{children:"Event Ticket"}),(0,s.jsx)("span",{className:"ticket-status ".concat(d?"expired":o?"pending":"confirmed"),children:d?"Expired":o?"Payment Pending":"Confirmed"})]}),(0,s.jsxs)("div",{className:"ticket-details",children:[(0,s.jsxs)("div",{className:"ticket-number",children:["#",null===t||void 0===t?void 0:t.ticketNumber]}),(0,s.jsx)("h4",{children:null===a||void 0===a?void 0:a.title}),(0,s.jsx)("p",{children:null!==a&&void 0!==a&&a.startDate?new Date(a.startDate).toLocaleDateString():""}),(null===t||void 0===t?void 0:t.paymentAmount)>0&&(0,s.jsxs)("div",{className:"ticket-price",children:[(0,s.jsx)("span",{className:"price-label",children:"Amount Paid:"}),(0,s.jsxs)("span",{className:"price-value",children:["$",t.paymentAmount.toFixed(2)]})]}),r&&(0,s.jsx)("div",{className:"ticket-free",children:(0,s.jsx)("span",{className:"free-badge",children:"FREE EVENT"})})]}),(0,s.jsx)("div",{className:"ticket-qr-wrapper",children:(0,s.jsx)(i.hp,{id:"ticket-qr-".concat(null===t||void 0===t?void 0:t._id),value:n,size:180,level:"H",includeMargin:!0})}),(0,s.jsx)("div",{className:"ticket-info",children:d?(0,s.jsx)("p",{className:"ticket-warning",children:"\u26a0\ufe0f This ticket has expired"}):o?(0,s.jsx)("p",{className:"ticket-warning",children:"\u26a0\ufe0f Complete payment to activate ticket"}):(0,s.jsx)("p",{children:"\u2713 Show this QR code at the event entrance"})}),(0,s.jsx)("div",{className:"ticket-actions",children:(0,s.jsx)("button",{className:"btn btn-primary",onClick:()=>{const e=document.getElementById("ticket-qr-".concat(null===t||void 0===t?void 0:t._id)),n=(new XMLSerializer).serializeToString(e),i=document.createElement("canvas"),s=i.getContext("2d"),a=new Image;a.onload=()=>{var e;i.width=a.width,i.height=a.height,s.drawImage(a,0,0);const n=i.toDataURL("image/png"),d=document.createElement("a");d.download="".concat((null===t||void 0===t||null===(e=t.event)||void 0===e?void 0:e.title)||"event","-ticket-").concat(null===t||void 0===t?void 0:t.ticketNumber,".png"),d.href=n,d.click()},a.src="data:image/svg+xml;base64,"+btoa(n)},disabled:o||d,children:o?"Payment Required":d?"Ticket Expired":"Download Ticket"})})]})})}}}]);
//# sourceMappingURL=236.b6071eed.chunk.js.map